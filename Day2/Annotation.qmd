---
title: "Annotation"
format: html
---

# Genome Annotation

# Prokka Annotation

### Basic Prokka run

`prokka--outdir /home/ubuntu/analysis/annotation/sample1_prokka--prefix sample1--genus Staphylococcus--species aureus--strain sample1--cpus 4/home/ubuntu/analysis/assembly/sample1_unicycler/assembly.fasta`

### View summary

`cat /home/ubuntu/analysis/annotation/sample1_prokka/sample1.txt`

Prokka outputs:

**.gff: Annotation in GFF3 format**

**.faa Protein sequences (amino acids)**

**.ffn Gene sequences (nucleotides)**

**.gbk: GenBank format**

**.txt: Summary statistics**

### Explore Annotation Files

Count features

`grep -v "#" sample1.gff | cut -f3 | sort | uniq -c`

### Count CDS

`grep -c "CDS" sample1.gff`

### Find specific genes (e.g., beta-lactamase)

`grep -i "beta-lactam" sample1.gff`

### Extract all gene product descriptions

`grep "product=" sample1.gff | sed 's/.product=([^;]).*/\1/' | sort | uniq -c | sort -rn | head -20`

#### Run Prokka for one sample

`cd /home/ubuntu/Data/`

`docker run -v $(pwd):$(pwd) -w $(pwd) staphb/prokka:latest prokka --outdir /home/ubuntu/Data/annotations/G18252308 --prefix G18252308 /home/ubuntu/Data/G18252308/illumina/G18252308_kmer51/contigs.fa`

Check if the *mecA* gene was found in the annotated genome.

![](images/grep%20mecA.png)

#### How to run Prokka on all samples from one folder

Example script: create the following bash file: `/home/ubuntu/Data/PROKKA_run/run_prokka.sh`

Add the following lines of code:

```         
for sample in`ls /home/ubuntu/Data/all_fastas/\*.fasta \| sed 's/.fasta//'\`

do

  echo \$sample

  output=\$(echo $sample | sed -E 's#.*/([^/]+)$#\\1#')

  echo \$output

  docker run -v $(pwd):$(pwd) -w $(pwd) staphb/prokka:latest prokka --outdir /home/ubuntu/Data/annotations/${output} --prefix ${output} /home/ubuntu/Data/all_fastas/${output}.fasta

done 
```

# Visualize in Artemis

# Launch Artemis from terminal

`art /home/ubuntu/analysis/annotation/sample1_prokka/sample1.gbk &`

# Or double-click the sample1.gbk file in file browser

Artemis tips:

View → Overview for whole genome view

Right-click genes for details Graph → GC Content to see compositional bias

Use "Goto" to jump to specific positions

**BLAST Specific Genes**

Extract a gene of interest:

`grep "mecA" sample1.gff | cut -f1,4,5`

# 
